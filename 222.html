<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://start.adspower.net/favicon.svg">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.4.4/luxon.min.js"></script>
  <title id="pageTitle">00:00:00</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f4;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      font-size: 24px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 8px;
    }
    .output {
      font-weight: bold;
      font-size: 18px;
      color: #333;
    }
    .btn {
      background-color: #4caf50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
    }
    .btn:hover {
      background-color: #45a049;
    }

    select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      padding: 10px 15px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #fff;
      width: 100%;
      color: #333;
      box-sizing: border-box;
      transition: border-color 0.3s ease, background-color 0.3s ease;
    }

    select:hover,
    select:focus {
      border-color: #4caf50;
      background-color: #f9f9f9;
      outline: none;
    }

    .select-wrapper {
      position: relative;
      display: inline-block;
      width: 100%;
    }

    .select-wrapper::after {
      content: '\2193';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      font-size: 16px;
      color: #999;
      pointer-events: none;
    }
  </style>
  <script>
    document.addEventListener('keydown', function (event) {
      if (event.key === 'F12' || event.keyCode === 123) {
        event.preventDefault();
        location.href = '/error/error';
      }
    });

    document.addEventListener('keydown', function (event) {
      if (
              (event.ctrlKey &&
                      event.shiftKey &&
                      (event.key === 'I' || event.key === 'i')) ||
              (event.ctrlKey &&
                      event.shiftKey &&
                      (event.key === 'J' || event.key === 'j')) ||
              (event.ctrlKey && (event.key === 'U' || event.key === 'u')) ||
              (event.ctrlKey && (event.key === 'S' || event.key === 's'))
      ) {
        event.preventDefault();
        location.href = '/error/error';
      }
    });

    //Right Key
    document.addEventListener('contextmenu', function (e) {
      e.preventDefault();
    });
  </script>
</head>
<body>
<div class="container">
  <h1>随机人设信息</h1>
  <div class="form-group">
    <label for="ip">IP 地址</label>
    <div id="ip" class="output"></div>
  </div>
  <div class="form-group">
    <label for="age">年龄/性别/出生</label>
    <div id="age" class="output"></div>
  </div>
  <div class="form-group">
    <label for="age-range">选择年龄范围</label
    ><select id="age-range" onchange="generateAgeInRange()">
    <option value="18-25">18-25</option>
    <option value="26-35">26-35</option>
    <option value="36-45">36-45</option>
    <option value="46-55">46-55</option>
    <option value="56-65">56-65</option>
    <option value="65+">65+</option>
  </select>
  </div>
  <div class="form-group" style="display: none;">
    <label for="dob">出生日期</label>
    <div id="dob" class="output"></div>
  </div>
  <div class="form-group"  style="display: none;">
    <label for="gender">性别</label>
    <div id="gender" class="output"></div>
  </div>
  <div class="form-group">
    <label for="zipcode">邮政编码</label>
    <div id="zipcode" class="output"></div>
  </div>
  <div class="form-group">
    <label for="city">城市</label>
    <div id="city" class="output"></div>
  </div>
  <div class="form-group" style="display: none;">
    <label for="region">州</label>
    <div id="region"  class="output"></div>
  </div>
  <div class="form-group">
    <label for="timezone">时区</label>
    <div id="timezone" class="output"></div>
  </div>
  <div class="form-group">
    <label for="time">时间</label>
    <div id="current-time" class="output"></div>
  </div>
  <div class="form-group">
    <label for="income">收入</label>
    <div id="income" class="output"></div>
  </div>
  <div class="form-group">
    <label for="Industry">行业</label
    ><select id="industrySelect" onchange="generateIndustry()"></select>
  </div>
  <!-- 添加复制按钮 -->
  <div>
    <button class="btn" id="copy-btn" onclick="copyToClipboard()">
      复制人设描述
    </button>
  </div>
  <br />
  <div>
    <input type="hidden" id="qa_data" /><a
          href="javascript:void(0);"
          onclick="click_ai()"
  ><button class="btn">问AI</button></a
  >
  </div>
</div>
<script>

    let startTime = new Date();

    function updateTimer() {
        const now = new Date();
        const elapsed = now - startTime;

        const hours = Math.floor(elapsed / 3600000);
        const minutes = Math.floor((elapsed % 3600000) / 60000);
        const seconds = Math.floor((elapsed % 60000) / 1000);

        const timeStr = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

        pageTitle.textContent = timeStr;
    }
    setInterval(updateTimer, 1000);


  let user_id =
          '248a0030aaeedf66c84fdcfcb6cd4ccca565d7ece08cddf1f53bc343736472ec';
  let userPostalCode = '';
  let city = '';
  let region = '';
  let timezone = '';
  let country = ''; // 新增 country 变量
  let ipAddress = ''; // 新增 IP 地址变量
  const select = document.getElementById('industrySelect');
  const professions = [
    'Accounting',
    'Advertising',
    'Agriculture/Fishing',
    'Architecture',
    'Automotive',
    'Aviation',
    'Banking/Financial',
    'Bio-Tech',
    'Brokerage',
    'Carpenting/Electrical installations/VVS',
    'Chemicals/Plastics/Rubber',
    'Communications/Information',
    'Computer Hardware',
    'Computer Reseller (software/hardware)',
    'Computer Software',
    'Construction',
    'Consulting',
    'Consumer Electronics',
    'Consumer Packaged Goods',
    'Education',
    'Energy/Utilities/Oil and Gas',
    'Engineering',
    'Environmental Services',
    'Fashion/Apparel',
    'Food/Beverage',
    'Government/Public Sector',
    'Healthcare',
    'Hospitality/Tourism',
    'Human Resources',
    'Information Technology/IT',
    'Insurance',
    'Internet',
    'Legal/Law',
    'Manufacturing',
    'Market Research',
    'Marketing/Sales',
    'Media/Entertainment',
    'Military',
    'Non Profit/Social services',
    'Personal Services',
    'Pharmaceuticals',
    'Printing Publishing',
    'Public Relations',
    'Real Estate/Property',
    'Retail/Wholesale trade',
    'Security',
    'Shipping/Distribution',
    'Telecommunications',
    'Transportation',
    'Other',
    "I don't work",
    'Marketing',
    'Sales',
    'Business Services',
    'Physical and Social Sciences',
    'Telemarking/ Call Center',
  ];

  const educationOptions = [
    'Below O-level / GCSE',
    'O-levels / GCSEs',
    'O-levels / GCSEs equivalent',
    'A-levels',
    'A-levels equivalent',
    'Undergraduate degree (less than 2 years)',
    'Undergraduate degree (3 years)',
    'Undergraduate degree (4 or more years)',
    'Post graduate: other (not PhD or MA)',
    'Post graduate: MA',
    'Post graduate: PhD',
  ];

  const jobTitleOptions = [
    'C-Level (e.g. CEO, CFO)',
    'Owner',
    'Partner',
    'President',
    'Vice President (EVP, SVP, AVP, VP)',
    'Director (Group Director, Sr. Director, Director)',
    'Manager (Group Manager, Sr. Manager, Manager, Program Manager)',
    'Analyst',
    'Assistant or Associate',
    'Administrative (Clerical or Support Staff)',
    'Consultant',
    'Intern',
    'Volunteer',
  ];
  const sydneyPostcodes = [
    { postcode: '2000', city: 'Sydney CBD' },
    { postcode: '2007', city: 'Ultimo' },
    { postcode: '2008', city: 'Chippendale' },
    { postcode: '2009', city: 'Pyrmont' },
    { postcode: '2010', city: 'Surry Hills' },
    { postcode: '2011', city: 'Potts Point' },
    { postcode: '2016', city: 'Redfern' },
    { postcode: '2021', city: 'Paddington' },
    { postcode: '2026', city: 'Bondi Beach' },
    { postcode: '2027', city: 'Edgecliff' },
    { postcode: '2028', city: 'Double Bay' },
    { postcode: '2029', city: 'Rose Bay' },
    { postcode: '2031', city: 'Randwick' },
    { postcode: '2034', city: 'Coogee' },
    { postcode: '2035', city: 'Maroubra' },
    { postcode: '2060', city: 'North Sydney' },
    { postcode: '2061', city: 'Kirribilli' },
    { postcode: '2065', city: 'Crows Nest' },
    { postcode: '2067', city: 'Chatswood' },
    { postcode: '2088', city: 'Mosman' },
    { postcode: '2089', city: 'Neutral Bay' },
    { postcode: '2134', city: 'Burwood' },
    { postcode: '2135', city: 'Strathfield' },
    { postcode: '2150', city: 'Parramatta' },
  ];
  const melbournePostcodes = [
    { postcode: '3000', city: 'Melbourne CBD' },
    { postcode: '3002', city: 'East Melbourne' },
    { postcode: '3003', city: 'West Melbourne' },
    { postcode: '3004', city: 'St Kilda Road' },
    { postcode: '3006', city: 'Southbank' },
    { postcode: '3008', city: 'Docklands' },
    { postcode: '3011', city: 'Footscray' },
    { postcode: '3012', city: 'West Footscray' },
    { postcode: '3031', city: 'Flemington' },
    { postcode: '3032', city: 'Maribyrnong' },
    { postcode: '3040', city: 'Essendon' },
    { postcode: '3051', city: 'North Melbourne' },
    { postcode: '3053', city: 'Carlton' },
    { postcode: '3054', city: 'Carlton North' },
    { postcode: '3065', city: 'Fitzroy' },
    { postcode: '3066', city: 'Collingwood' },
    { postcode: '3067', city: 'Abbotsford' },
    { postcode: '3070', city: 'Northcote' },
    { postcode: '3121', city: 'Richmond' },
    { postcode: '3141', city: 'South Yarra' },
    { postcode: '3142', city: 'Toorak' },
    { postcode: '3181', city: 'Prahran' },
    { postcode: '3182', city: 'St Kilda' },
  ];
  const brisbanePostcodes = [
    { postcode: '4000', city: 'Brisbane CBD' },
    { postcode: '4005', city: 'New Farm' },
    { postcode: '4006', city: 'Fortitude Valley' },
    { postcode: '4007', city: 'Hamilton' },
    { postcode: '4010', city: 'Albion' },
    { postcode: '4011', city: 'Clayfield' },
    { postcode: '4012', city: 'Nundah' },
    { postcode: '4030', city: 'Lutwyche' },
    { postcode: '4032', city: 'Chermside' },
    { postcode: '4051', city: 'Kelvin Grove' },
    { postcode: '4053', city: 'Stafford' },
    { postcode: '4064', city: 'Paddington' },
    { postcode: '4066', city: 'Toowong' },
    { postcode: '4067', city: 'St Lucia' },
    { postcode: '4075', city: 'Sherwood' },
    { postcode: '4101', city: 'South Brisbane' },
    { postcode: '4102', city: 'Woolloongabba' },
    { postcode: '4103', city: 'Annerley' },
    { postcode: '4104', city: 'Fairfield' },
    { postcode: '4105', city: 'Moorooka' },
    { postcode: '4151', city: 'Coorparoo' },
    { postcode: '4171', city: 'Bulimba' },
  ];

  const adelaidePostcodes = [
    { postcode: '5000', city: 'Adelaide CBD' },
    { postcode: '5006', city: 'North Adelaide' },
    { postcode: '5007', city: 'Bowden' },
    { postcode: '5008', city: 'Hindmarsh' },
    { postcode: '5009', city: 'Croydon' },
    { postcode: '5010', city: 'Kilburn' },
    { postcode: '5012', city: 'Port Adelaide' },
    { postcode: '5013', city: 'Gillman' },
    { postcode: '5021', city: 'Henley Beach' },
    { postcode: '5022', city: 'West Beach' },
    { postcode: '5031', city: 'Keswick' },
    { postcode: '5032', city: 'Mile End' },
    { postcode: '5033', city: 'Brooklyn Park' },
    { postcode: '5041', city: 'Glen Osmond' },
    { postcode: '5042', city: 'Clovelly Park' },
    { postcode: '5043', city: 'Edwardstown' },
    { postcode: '5045', city: 'Glenelg' },
    { postcode: '5061', city: 'Myrtle Bank' },
    { postcode: '5062', city: 'Urrbrae' },
    { postcode: '5067', city: 'Norwood' },
  ];

  const personalityTraitOptions = [
    '注重细节但不会过于挑剔',
    '倾向理性判断但不排斥情感驱动',
    '比较务实，喜欢功能比品牌更重要',
    '喜欢尝试新鲜事物，乐于探索',
    '追求性价比但不喜欢廉价感',
    '有一点完美主义，重视使用体验',
    '容易被朋友或社群推荐影响',
    '对品牌忠诚但也会理智比较',
    '讨厌被广告轰炸，更信任真实体验',
    '重视隐私保护，对科技产品比较敏感',
    '情绪稳定但讨厌麻烦',
    '喜欢简洁高效的流程设计',
    '比较内向，更喜欢独处',
    '高度自律，有条理',
    '喜欢掌控一切，不喜欢不确定',
    '愿意冒险，做事有冲劲',
    '对他人的情绪非常敏感',
    '注重个人成长，喜欢学习新知识',
    '直率但有时稍微过于直接',
    '喜欢在舒适区内工作，不喜欢变化',
    '喜欢团队合作，强调协作',
    '喜欢竞争并追求成绩',
    '思想开放，愿意接受新观念',
    '优先考虑长远目标而非短期享受',
    '对细节敏感，喜欢高标准',
    '自信但不自负',
    '乐观向上，善于调节情绪',
    '有些急躁，喜欢快速解决问题',
    '注重工作与生活的平衡',
    '生活态度积极，喜欢社交',
    '喜欢深度思考问题',
    '偏好定制化或个性化的体验',
    '忠诚于自己，但愿意倾听他人意见',
    '喜欢迎接挑战，做事积极主动',
    '追求高效，不喜欢浪费时间',
    '情感丰富，容易受到外界影响',
    '注重过程而非结果',
    '独立思考，喜欢自己做决定',
    '关心社会问题，愿意参与公益',
    '有些怀疑主义，喜欢验证信息',
    '习惯规划和提前安排',
    '喜欢保持高度的隐私保护',
    '喜欢分享经验，但也注重个人空间',
    '对新科技充满好奇心',
    '直觉驱动，做决定依赖直觉',
    '遇到问题喜欢先解决再思考后果',
    '倾向于避免冲突，追求和谐',
    '做事脚踏实地，不容易急躁',
    '对生活细节要求高，追求完美',
    '不轻易相信陌生人或广告',
    '喜欢简约风格，崇尚极简主义',
    '心思细腻，容易产生共鸣',
    '非常有耐心，做事谨慎周到',
    '容易感受到压力，需要较多时间调整',
    '善于激励和影响他人',
    '重视细节，耐心打磨每个环节',
    '非常注重安全和健康',
    '享受小确幸，关注个人幸福感',
    '感性并且有浪漫倾向',
    '较为内向，更倾向独立完成任务',
    '有时有点偏执，喜欢规避风险',
    '有很强的责任心，处理事情非常认真',
  ];
  const industryFocusOptions = [
    '信息技术与软件开发',
    '金融服务与投资管理',
    '医疗健康与生物科技',
    '电子商务与网络零售',
    '教育与在线学习',
    '广告与数字营销',
    '数据科学与人工智能',
    '云计算与网络基础设施',
    '网络安全与隐私保护',
    '电信与通信技术',
    '汽车与智能交通',
    '房地产开发与物业管理',
    '能源与可再生能源',
    '制造业与工业自动化',
    '航空航天与国防',
    '法律服务与合规咨询',
    '公共关系与品牌管理',
    '餐饮与食品服务',
    '娱乐与媒体内容制作',
    '游戏开发与互动娱乐',
    '时尚与服饰设计',
    '体育与健身产业',
    '旅游与酒店管理',
    '零售与连锁经营',
    '物流与供应链管理',
    '非营利组织与社会企业',
    '政府机构与公共服务',
    '环境保护与可持续发展',
    '建筑设计与城市规划',
    '农业与食品科技',
    '文化与艺术创意产业',
    '区块链与加密货币',
    '宠物产业与兽医服务',
    '美容与个人护理',
    '高等教育与学术研究',
    '家庭护理与老年服务',
    '保险与风险管理',
    '咨询服务与战略顾问',
    '人力资源与招聘服务',
    '消费电子与智能设备',
    '海洋与渔业技术',
    '电力与基础设施建设',
    '铁路与公共交通系统',
    '无人机与机器人技术',
    'VR/AR 与沉浸式体验',
    '心理健康与情绪支持',
    '语言服务与翻译本地化',
    '儿童教育与玩具设计',
    '室内设计与家居装饰',
    '工艺品与手工市场',
  ];
  const interestOptions = [
    '环境保护',
    '气候变化',
    '健康饮食',
    '心理健康',
    '健身与锻炼',
    '冥想与正念',
    '工作与生活平衡',
    '家庭关系',
    '宠物护理',
    '旅行探索',
    '数码科技',
    '手机和App评测',
    '电子游戏',
    '人工智能趋势',
    '创业与创新',
    '财务自由',
    '投资理财',
    '房地产市场',
    '网络安全',
    '数据隐私',
    '时尚潮流',
    '护肤与美容',
    '可持续生活',
    '植物养护',
    '咖啡文化',
    '烹饪与美食',
    '摄影艺术',
    '电影与剧集',
    '音乐欣赏',
    '社交媒体内容',
    '个人品牌建设',
    '职业成长',
    '领导力发展',
    '远程办公',
    '教育改革',
    '儿童教育',
    '语言学习',
    '读书与写作',
    '性别平等',
    '多元文化',
    '社会公正',
    '科技伦理',
    '宇宙与太空探索',
    '机器人发展',
    '可再生能源',
    '绿色建筑',
    '交通出行',
    '心理学研究',
    '人类行为学',
    '品牌忠诚',
    '客户体验优化',
    '数字营销趋势',
    '内容创作',
    '用户体验设计',
    '开源技术',
    '区块链技术',
    'NFT与加密艺术',
    '虚拟现实',
    'AI绘画与创作',
    'Web3生态系统',
  ];

  // 获取用户 IP 信息
  async function getIpInfo() {
    try {
      const response = await fetch('https://ipinfo.io/json');
      const data = await response.json();
      userPostalCode = data.postal || '未知';
      city = data.city + '  -  ' +data.region+ '  -  ' + data.country|| '未知';
      region = data.region || '未知';
      timezone = data.timezone || '未知';
      country = data.country || 'unknown';
      ipAddress = data.ip || '未知'; // 获取 IP 地址
      localStorage.setItem('zipcode', userPostalCode);
      localStorage.setItem('city', city);
      localStorage.setItem('region', region);
      localStorage.setItem('timezone', timezone); // 存储时区
      localStorage.setItem('country', country); // 存储国家
      localStorage.setItem('ip', ipAddress); // 存储 IP 地址
      // 显示时区
      professions.forEach((prof) => {
        const option = document.createElement('option');
        option.value = prof;
        option.textContent = prof;
        select.appendChild(option);
      });

      const storedProfession = localStorage.getItem('selectedProfession');
      const defaultProfession =
              storedProfession ||
              professions[Math.floor(Math.random() * professions.length)];
      select.value = defaultProfession;
      localStorage.setItem('selectedProfession', defaultProfession);
      document.getElementById('timezone').textContent = timezone;
      document.getElementById('zipcode').innerText = userPostalCode;
      document.getElementById('city').innerText = city;
      document.getElementById('region').innerText = region;

      document.getElementById('ip').textContent = ipAddress;
      // 验证时区是否有效
      if (
              timezone !== '未知' &&
              luxon.DateTime.now().setZone(timezone).isValid
      ) {
        updateTime();
      } else {
        document.getElementById('current-time').textContent =
                'Invalid Timezone';
      }
    } catch (error) {
      console.error('Error fetching IP info:', error);
      document.getElementById('timezone').textContent = '未知';
      document.getElementById('current-time').textContent =
              'Error fetching timezone';
      timezone = 'UTC';
    }
  }
  function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }
  // 函数：更新时间
  function updateTime() {
    const userTimezone =
            timezone !== '未知' && luxon.DateTime.now().setZone(timezone).isValid
                    ? timezone
                    : 'UTC';
    const currentTime = luxon.DateTime.now()
            .setZone(userTimezone)
            .toFormat('yyyy-MM-dd HH:mm:ss');
    document.getElementById('current-time').textContent = currentTime;
  }

  // 添加复制功能
  function copyToClipboard() {
    const age = localStorage.getItem('age')
    console.log(age);
    const gender = document.getElementById('gender').textContent;
    // const job_title = pickRandom(jobTitleOptions);
    const job_title = document.getElementById('industrySelect').value;
    // const education = pickRandom(educationOptions);
    const income = document.getElementById('income').textContent;
    const region = document.getElementById('region').textContent;
    const industry_focus = pickRandom(industryFocusOptions);
    const personality_trait = pickRandom(personalityTraitOptions);
    const interest_or_concern = pickRandom(interestOptions);

    let countryValue =
            country || localStorage.getItem('country') || 'unknown';

    const description = `${country},${age},${gender},${job_title},${income}`;

    // document.getElementById('qa_data').value = description
    navigator.clipboard
            .writeText(description)
            .then(() => {
              alert('已复制到剪贴板: ' + description);
            })
            .catch((err) => {
              console.error('复制失败:', err);
              // alert('复制失败，请手动复制: ' + description);
            });
  }

  function copyToClipboard2() {
    const age = localStorage.getItem('age')
    const gender = document.getElementById('gender').textContent;
    const job_title = document.getElementById('industrySelect').value;
    const education = pickRandom(educationOptions);
    const income = document.getElementById('income').textContent;
    const region = document.getElementById('region').textContent;
    const industry_focus = pickRandom(industryFocusOptions);
    const personality_trait = pickRandom(personalityTraitOptions);
    const interest_or_concern = pickRandom(interestOptions);
    let countryValue =
            country || localStorage.getItem('country') || 'unknown';

    const description = `你是一个生活在 ${country}（按国际地区编码）地区 的 ${age} 岁 ${gender}，从事 ${job_title} 职业，拥有 ${education} 学历，年收入约为 ${income}。你长期居住在 ${region}，对 ${region} 本地的 ${job_title} 等方面有深刻的了解。你注重生活品质，${personality_trait}，平时关注 ${interest_or_concern}，也会根据个人习惯和经验做出真实判断。
  目标是：让任何人看到这些答案时，都相信是一个真实的 ${country} 的 ${job_title} 在认真作答。

      请你以“第一人称”的方式自然作答，就像你在真实填写一份问卷一样。回答应展现出贴近你身份背景的生活逻辑、人类情感与消费经验，包含真实的观点、偏好、品牌印象或生活细节。

      [character_config]

      目标是：让任何人看到这些答案时，都相信是一个真实的 ${country} 的 ${job_title} 在认真作答。
      `;

    document.getElementById('qa_data').value = description;
  }

  // 获取当前日期
  function getCurrentDate() {
    const today = new Date();
    return {
      year: today.getFullYear(),
      month: today.getMonth() + 1,
      day: today.getDate(),
    };
  }

  // 生成随机整数
  function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  // 计算出生日期
  function getRandomBirthDate(age) {
    const {
      year: currentYear,
      month: currentMonth,
      day: currentDay,
    } = getCurrentDate();

    let birthYear = currentYear - age;
    let birthMonth = getRandomInt(1, 12);
    let birthDay = getRandomInt(1, 28);

    if (
            birthMonth > currentMonth ||
            (birthMonth === currentMonth && birthDay > currentDay)
    ) {
      birthYear -= 1;
    }

    return `${birthYear}-${String(birthMonth).padStart(2, '0')}-${String(
            birthDay
    ).padStart(2, '0')}`;
  }

  // 生成随机收入
  function getIncome() {
    const incomes = [
      '低于 $20,000',
      '$20,000 - $39,999',
      '$40,000 - $59,999',
      '$60,000 - $79,999',
      '$80,000 - $99,999',
      '$100,000 以上',
    ];
    return incomes[getRandomInt(0, incomes.length - 1)];
  }

  // 生成随机人设
  function generateRandomPerson(forceNew = false) {
    if (!forceNew && localStorage.getItem('age')) {
      document.getElementById('age').innerText =
              localStorage.getItem('age') + '   ' +localStorage.getItem('gender')  + '   '+ localStorage.getItem('dob');
      document.getElementById('dob').innerText =
              localStorage.getItem('dob');
      document.getElementById('gender').innerText =
              localStorage.getItem('gender');
      document.getElementById('zipcode').innerText =
              localStorage.getItem('zipcode') || '未知';
      document.getElementById('income').innerText =
              localStorage.getItem('income');
      document.getElementById('city').innerText =
              localStorage.getItem('city') || '未知';
      document.getElementById('region').innerText =
              localStorage.getItem('region') || '未知';
      return;
    }

    const age = getRandomInt(18, 70);
    const birthDate = getRandomBirthDate(age);
    const genders = ['男', '女'];
    const gender = genders[getRandomInt(0, genders.length - 1)];
    const income = getIncome();

    localStorage.setItem('age', age);
    localStorage.setItem('dob', birthDate);
    localStorage.setItem('gender', gender);
    localStorage.setItem('income', income);

    document.getElementById('age').innerText = age;
    document.getElementById('dob').innerText = birthDate;
    document.getElementById('gender').innerText = gender;
    document.getElementById('zipcode').innerText =
            localStorage.getItem('zipcode') || '未知';
    document.getElementById('income').innerText = income;
    document.getElementById('city').innerText =
            localStorage.getItem('city') || '未知';
    document.getElementById('region').innerText =
            localStorage.getItem('region') || '未知';
  }

  // 重新生成年龄（覆盖原来年龄）
  function generateAgeInRange() {
    const range = document.getElementById('age-range').value;
    const [min, max] = range.split('-').map(Number);
    let age =
            range === '65+' ? getRandomInt(65, 70) : getRandomInt(min, max);

    const birthDate = getRandomBirthDate(age);
    localStorage.setItem('age', age);
    localStorage.setItem('dob', birthDate);

    document.getElementById('age').innerText = age + '   ' + localStorage.getItem('gender')  + '   '+ birthDate;
    document.getElementById('dob').innerText = birthDate;
  }

  function generateIndustry() {
    select.addEventListener('change', (e) => {
      localStorage.setItem('selectedProfession', e.target.value);
    });
  }

  // 页面加载时获取IP信息 & 读取本地存储
  window.onload = async () => {
    // 每次加载页面都重新获取 IP 信息，确保时区是最新的
    await getIpInfo();

    // 如果本地存储有 timezone，直接使用
    if (localStorage.getItem('timezone')) {
      timezone = localStorage.getItem('timezone');
      document.getElementById('timezone').textContent = timezone;
      if (
              timezone !== '未知' &&
              luxon.DateTime.now().setZone(timezone).isValid
      ) {
        updateTime();
      }
    }

    generateRandomPerson();

    fixAustraliaPostcode();
    setInterval(() => {
      if (
              timezone !== '未知' &&
              luxon.DateTime.now().setZone(timezone).isValid
      ) {
        updateTime();
      }
    }, 1000);
  };
  function fixAustraliaPostcode() {
    console.log('fixAustraliaPostcode');
    const countryValue = country || localStorage.getItem('country');
    let currentZip = (
            document.getElementById('zipcode').innerText || ''
    ).trim();
    console.log('currentZip', currentZip);

    // 是否需要修正？
    const needsFix =
            (countryValue === 'AU' && currentZip.endsWith('000')) ||
            currentZip === '1001'; // ← 新增：专门处理1001

    if (!needsFix) return;

    let newItem;

    // 1001 → 强制悉尼
    if (currentZip === '1001') {
      newItem =
              sydneyPostcodes[Math.floor(Math.random() * sydneyPostcodes.length)];
    } else if (currentZip.startsWith('2')) {
      // 悉尼
      newItem =
              sydneyPostcodes[Math.floor(Math.random() * sydneyPostcodes.length)];
    } else if (currentZip.startsWith('3')) {
      // 墨尔本
      newItem =
              melbournePostcodes[
                      Math.floor(Math.random() * melbournePostcodes.length)
                      ];
    } else if (currentZip.startsWith('4')) {
      // 布里斯班
      newItem =
              brisbanePostcodes[
                      Math.floor(Math.random() * brisbanePostcodes.length)
                      ];
    } else if (currentZip.startsWith('5')) {
      // 阿德莱德
      newItem =
              adelaidePostcodes[
                      Math.floor(Math.random() * adelaidePostcodes.length)
                      ];
    }

    if (newItem) {
      document.getElementById('zipcode').innerText = newItem.postcode;
      document.getElementById('city').innerText = newItem.city;

      // 如果你希望 region 也修正（推荐这样做）
      const regionEl = document.getElementById('region');
      if (regionEl) {
        const stateMap = {
          2: 'New South Wales', // NSW
          3: 'Victoria', // VIC
          4: 'Queensland', // QLD
          5: 'South Australia', // SA
        };

        let regionName = 'New South Wales'; // 默认悉尼
        if (currentZip === '1001') {
          regionName = 'New South Wales';
        } else {
          const prefix = currentZip.charAt(0);
          if (stateMap[prefix]) {
            regionName = stateMap[prefix];
          }
        }

        regionEl.innerText = regionName;
        localStorage.setItem('region', regionName);
      }

      localStorage.setItem('zipcode', newItem.postcode);
      localStorage.setItem('city', newItem.city);


    }
  }

  function base64Encode(str) {
    // 1. 将字符串转换为 UTF-8 编码的字节流（URI 编码）
    const utf8Str = encodeURIComponent(str);

    // 2. 将 URI 编码的字符串转换为二进制字符串（每个字符对应一个字节）
    const binaryStr = utf8Str.replace(/%([0-9A-F]{2})/g, (_, hex) =>
            String.fromCharCode(parseInt(hex, 16))
    );

    // 3. 使用 btoa() 进行 Base64 编码
    return btoa(binaryStr);
  }

  function click_ai() {
    copyToClipboard2();
    let qa = document.getElementById('qa_data').value;
    const link = document.createElement('a');
    link.href =
            'https://chat.zxdatabase.com/index/index?pid=' +
            user_id +
            '&qa=' +
            encodeURIComponent(qa);
    link.target = '_blank';
    link.style.display = 'none';
    document.body.appendChild(link);
    link.click();
    // location.href = 'https://chat.zxdatabase.com/index/index?pid=1_'+user_id+'&qa='+encodeURIComponent(qa)
  }
</script>
</body>
</html>
